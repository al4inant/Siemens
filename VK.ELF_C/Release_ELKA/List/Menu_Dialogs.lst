##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    16/Feb/2023  22:41:13 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Menu_Dialogs.c                                      #
#    Command line    =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Menu_Dialogs.c -D NEWSGOLD -D ELKA -D DEBUG -lCN    #
#                       D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\List\ -la D:\Users\alfinant\Documents\ #
#                       Siemens\Dev\IAR\VK.ELF_C\Release_ELKA\List\ -o       #
#                       D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\Obj\ -z9 --cpu_mode arm --endian       #
#                       little --cpu ARM926EJ-S --stack_align 4 --interwork  #
#                       --diag_suppress Pe301 -e --fpu None --dlib_config    #
#                       D:\Users\alfinant\Documents\Siemens\IAR\ARM\LIB\dl5t #
#                       painl8n.h -I D:\Users\alfinant\Documents\Siemens\IAR #
#                       \ARM\INC\ --inline_threshold=2                       #
#    List file       =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\List\Menu_Dialogs.lst                  #
#    Object file     =  D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C #
#                       \Release_ELKA\Obj\Menu_Dialogs.r79                   #
#                                                                            #
#                                                                            #
##############################################################################

D:\Users\alfinant\Documents\Siemens\Dev\IAR\VK.ELF_C\Menu_Dialogs.c
      1          #include <siemens\swilib.h>
      2          #include "rect_patcher.h"

   \                                 In segment CODE, align 4, keep-with-next
   \   __??Code32?? __code __interwork __atpcs void patch_header(HEADER_DESC const *)
   \                     patch_header:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   B000C4E1           STRH     R0,[R4, #+0]
   \   00000010   1800A0E3           MOV      R0,#+24
   \   00000014   B200C4E1           STRH     R0,[R4, #+2]
   \   00000018   888100EF           SWI      +33160
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   B400C4E1           STRH     R0,[R4, #+4]
   \   00000024   8A8100EF           SWI      +33162
   \   00000028   170080E2           ADD      R0,R0,#+23
   \   0000002C   B600C4E1           STRH     R0,[R4, #+6]
   \   00000030   1080BDE8           POP      {R4,PC}          ;; return
      3          #include <siemens\pnglist.h>
      4          #include "dyn_images.h"
      5          #include "dyn_theme.h"
      6          #include "process.h"
      7          #include "socket_work.h"
      8          #include "http.h"
      9          #include "vk_api.h"
     10          #include "main.h"
     11          #include "anim_widget.h"
     12          #include "string_util.h"
     13          #include "vk_work.h"
     14          
     15          static int gui_id = 0;
     16          static int timer_id;
     17          

   \                                 In segment DATA_C, align 4, align-sorted
     18          static const char percent_t[]="%t";
   \                     percent_t:
   \   00000000   257400             DC8 "%t"
   \   00000003   256400             DC8 "%d"
   \   00000006   0000               DC8 0, 0
   \   00000008   667269656E64       DC8 "friend_status,has_photo,photo_50,online"
   \              5F7374617475
   \              732C6861735F
   \              70686F746F2C
   \              70686F746F5F
   \              35302C6F6E6C
   \              696E6500    
   \   00000030   6861735F7068       DC8 "has_photo,photo_50,online"
   \              6F746F2C7068
   \              6F746F5F3530
   \              2C6F6E6C696E
   \              6500        
   \   0000004A   0000               DC8 0, 0
   \   0000004C   256420E2EBEE       DC8 "%d \342\353\356\346\345\355\350\377"
   \              E6E5EDE8FF00
   \   00000058   D4EEF2EEE3F0       DC8 "\324\356\362\356\343\360\340\364\350\377"
   \              E0F4E8FF00  
   \   00000063   00                 DC8 0
   \   00000064   C2E8E4E5EE00       DC8 "\302\350\344\345\356"
   \   0000006A   0000               DC8 0, 0
   \   0000006C   C0F3E4E8EEE7       DC8 "\300\363\344\350\356\347\340\357\350\361\374"
   \              E0EFE8F1FC00
   \   00000078   C4EEEAF3ECE5       DC8 "\304\356\352\363\354\345\355\362"
   \              EDF200      
   \   00000081   000000             DC8 0, 0, 0
   \   00000084   D1F1FBEBEAE0       DC8 "\321\361\373\353\352\340"
   \              00          
   \   0000008B   00                 DC8 0
   \   0000008C   D2EEE2E0F000       DC8 "\322\356\342\340\360"
   \   00000092   0000               DC8 0, 0
   \   00000094   CFEEE4E1EEF0       DC8 "\317\356\344\341\356\360\352\340 \362\356\342\340\360\356\342"
   \              EAE020F2EEE2
   \              E0F0EEE200  
   \   000000A5   000000             DC8 0, 0, 0
   \   000000A8   C7E0EFE8F1FC       DC8 "\307\340\357\350\361\374 \355\340 \361\362\345\355\345"
   \              20EDE020F1F2
   \              E5EDE500    
   \   000000B8   CAEEECECE5ED       DC8 "\312\356\354\354\345\355\362\340\360\350\351 \355\340 \361\362\345\355\345"
   \              F2E0F0E8E920
   \              EDE020F1F2E5
   \              EDE500      
   \   000000CD   000000             DC8 0, 0, 0
   \   000000D0   D1F2E8EAE5F0       DC8 "\321\362\350\352\345\360"
   \              00          
   \   000000D7   00                 DC8 0
   \   000000D8   CFEEE4E0F0EE       DC8 "\317\356\344\340\360\356\352"
   \              EA00        
   \   000000E0   D1EEEEE1F9E5       DC8 "\321\356\356\341\371\345\355\350\377"
   \              EDE8FF00    
   \   000000EA   0000               DC8 0, 0
   \   000000EC   25642F256400       DC8 "%d/%d"
   \   000000F2   0000               DC8 0, 0

   \                                 In segment DATA_I, align 4, align-sorted
     19          static const char percent_d[]="%d";
     20          
     21          static HEADER_DESC hdr={0,0,0,0,NULL,NULL,LGP_NULL};
   \                     hdr:
   \   00000000                      DS8 20
   \   00000014                      REQUIRE `?<Initializer for hdr>`
   \   00000014                      DS8 4
   \   00000018                      REQUIRE `?<Initializer for gui_id>`
   \   00000018                      DS8 4
   \   0000001C                      REQUIRE `?<Initializer for timer_id>`
   \   0000001C                      DS8 4
   \   00000020                      REQUIRE `?<Initializer for ws_hdr>`
   \   00000020                      DS8 4
   \   00000024                      REQUIRE `?<Initializer for items_count>`
   \   00000024                      DS8 4
   \   00000028                      REQUIRE `?<Initializer for cursor_pos>`
   \   00000028                      DS8 4
   \   0000002C                      REQUIRE `?<Initializer for hdr_icon>`
     22          static WSHDR  *ws_hdr = NULL;
     23          static int items_count = 0;
     24          static int cursor_pos = 0;
     25          static int loaded_count = 0;
     26          
     27          #ifdef ELKA
     28          static int hdr_icon=0x599;
     29          #else
     30          static int hdr_icon=0x5C5;
     31          #endif
     32          

   \                                 In segment CODE, align 4, keep-with-next
     33          void set_DialogsCount(int count)
     34          {
     35            items_count = count;
   \                     set_DialogsCount:
   \   00000000   ........           LDR      R1,??DataTable4  ;; hdr + 32
   \   00000004   000081E5           STR      R0,[R1, #+0]
     36          }
   \   00000008   1EFF2FE1           BX       LR               ;; return
     37          

   \                                 In segment CODE, align 4, keep-with-next
     38          int get_DialogsCount()
     39          {
     40            return items_count;
   \                     get_DialogsCount:
   \   00000000   ........           LDR      R0,??DataTable4  ;; hdr + 32
   \   00000004   000090E5           LDR      R0,[R0, #+0]
   \   00000008   1EFF2FE1           BX       LR               ;; return
     41          }
     42          

   \                                 In segment DATA_C, align 4, align-sorted
     43          static const int menusoftkeys[]={0,1,2};
   \                     menusoftkeys:
   \   00000000   000000000100       DC32 0, 1, 2
   \              000002000000
     44          

   \                                 In segment DATA_I, align 4, align-sorted
     45          static SOFTKEY_DESC sk[]=
   \                     sk:
   \   00000000                      DS8 24
   \   00000018                      REQUIRE `?<Initializer for sk>`
     46          {
     47            {0x0018,0x0000,(int)"Обновить"},
     48            {0x0001,0x0000, (int)"Назад"},
     49            {0x003D,0x0000,(int)LGP_DOIT_PIC}
     50          };
     51          

   \                                 In segment DATA_I, align 4, align-sorted
     52          static SOFTKEYSTAB skt=
   \                     skt:
   \   00000000                      DS8 8
   \   00000008                      REQUIRE `?<Initializer for skt>`
     53          {
     54            sk,0
     55          };
     56          

   \                                 In segment CODE, align 4, keep-with-next
     57          static int items_menu_onkey(void *gui, GUI_MSG *msg)
     58          {
   \                     items_menu_onkey:
   \   00000000   00402DE9           PUSH     {LR}
     59            extern void CreateChat(VkDialog *dialog);
     60            extern int CreateDebugGUI();
     61            extern void Logout();
     62            
     63            VkDialog *dialog;
     64            struct list_head *pos;
     65            int i;
     66            
     67            if ((msg->gbsmsg->msg==KEY_DOWN)||(msg->gbsmsg->msg==LONG_PRESS))
   \   00000004   041091E5           LDR      R1,[R1, #+4]
   \   00000008   9330A0E3           MOV      R3,#+147
   \   0000000C   042091E5           LDR      R2,[R1, #+4]
   \   00000010   403F83E3           ORR      R3,R3,#0x100
   \   00000014   030052E1           CMP      R2,R3
   \   00000018   02308312           ADDNE    R3,R3,#+2
   \   0000001C   03005211           CMPNE    R2,R3
   \   00000020   0D00001A           BNE      ??items_menu_onkey_0
     68            { 
     69              switch(msg->gbsmsg->submess)
   \   00000024   081091E5           LDR      R1,[R1, #+8]
   \   00000028   011051E2           SUBS     R1,R1,#+1
   \   0000002C   0E00000A           BEQ      ??items_menu_onkey_1
   \   00000030   031051E2           SUBS     R1,R1,#+3
   \   00000034   1D00000A           BEQ      ??items_menu_onkey_2
   \   00000038   071051E2           SUBS     R1,R1,#+7
   \   0000003C   0800000A           BEQ      ??items_menu_onkey_3
   \   00000040   0F1051E2           SUBS     R1,R1,#+15
   \   00000044   0400001A           BNE      ??items_menu_onkey_0
     70              {     
     71              case ENTER_BUTTON:
     72                i = GetCurMenuItem(gui);
   \   00000048   8F0100EF           SWI      +399
     73                pos = get_ListByIndex(&dialogs, i);
   \   0000004C   0010A0E1           MOV      R1,R0
   \   00000050   ........           LDR      R0,??DataTable14  ;; dialogs
   \   00000054   ........           _BLF     get_ListByIndex,??get_ListByIndex??rA
     74                dialog = list_entry(pos, VkDialog, list);
     75                CreateChat(dialog);
   \   00000058   ........           _BLF     CreateChat,??CreateChat??rA
     76                break;
     77              
     78              case GREEN_BUTTON:
     79          #ifdef DEBUG
     80                CreateDebugGUI();
     81          #endif
     82                break;
     83                
     84              case LEFT_SOFT:
     85                if (INET_PROCESS==0)
     86                {
     87                  INET_PROCESS=LOAD_DIALOGS;
     88                  int offset= items_count-loaded_count;
     89                  SUBPROC((void*)HttpSendReq, url_messages_getConversations(offset, 10, 1, "photo_50,online"));//запрос списка диалогов
     90                  AnimWidget_Wait_headline();
     91                } 
     92                break;      
     93                
     94              case RIGHT_SOFT://close
     95                return(1);
     96              }
     97            }
     98            return (0);  
   \                     ??items_menu_onkey_0:
   \   0000005C   0000A0E3           MOV      R0,#+0
   \   00000060   0080BDE8           POP      {PC}             ;; return
   \                     ??items_menu_onkey_3:
   \   00000064   ........           _BLF     CreateDebugGUI,??CreateDebugGUI??rA
   \   00000068   FBFFFFEA           B        ??items_menu_onkey_0
   \                     ??items_menu_onkey_1:
   \   0000006C   ........           LDR      R0,??DataTable8  ;; INET_PROCESS
   \   00000070   001090E5           LDR      R1,[R0, #+0]
   \   00000074   000051E3           CMP      R1,#+0
   \   00000078   F7FFFF1A           BNE      ??items_menu_onkey_0
   \   0000007C   34309FE5           LDR      R3,??items_menu_onkey_4  ;; `?<Constant "photo_50,online">`
   \   00000080   0C10A0E3           MOV      R1,#+12
   \   00000084   001080E5           STR      R1,[R0, #+0]
   \   00000088   ........           LDR      R0,??DataTable4  ;; hdr + 32
   \   0000008C   0120A0E3           MOV      R2,#+1
   \   00000090   000090E5           LDR      R0,[R0, #+0]
   \   00000094   0A10A0E3           MOV      R1,#+10
   \   00000098   ........           _BLF     url_messages_getConversations,??url_messages_getConversations??rA
   \   0000009C   0010A0E1           MOV      R1,R0
   \   000000A0   ........           LDR      R0,??DataTable6  ;; HttpSendReq
   \   000000A4   710100EF           SWI      +369
   \   000000A8   ........           _BLF     AnimWidget_Wait_headline,??AnimWidget_Wait_headline??rA
   \   000000AC   EAFFFFEA           B        ??items_menu_onkey_0
   \                     ??items_menu_onkey_2:
   \   000000B0   0100A0E3           MOV      R0,#+1
   \   000000B4   0080BDE8           POP      {PC}
   \                     ??items_menu_onkey_4:
   \   000000B8   ........           DC32     `?<Constant "photo_50,online">`
     99          }
    100          
    101          static void UpdateHeader()
    102          {
    103            ws_hdr->wsbody[0] = 0; 
    104            wsAppendChar(ws_hdr, UTF16_ENA_CENTER);
    105            wsprintf(ws_hdr, percent_t, "Сообщения");
    106            wsAppendChar(ws_hdr, UTF16_ALIGN_RIGHT);
    107            wstrcatprintf(ws_hdr, "%d/%d", cursor_pos, items_count);
    108          }
    109          
    110          extern void LoadSavedDialogs();
    111          

   \                                 In segment CODE, align 4, keep-with-next
    112          static void items_menu_ghook(void *data, int cmd)
    113          {
   \                     items_menu_ghook:
   \   00000000   F14F2DE9           PUSH     {R0,R4-R11,LR}
    114            GUI *gui = (GUI*)data;
    115            
    116            if (cmd == TI_CMD_CREATE)
   \   00000004   ........           LDR      R4,??DataTable6  ;; HttpSendReq
   \   00000008   ........           LDR      R7,??DataTable12  ;; percent_t
   \   0000000C   ........           LDR      R5,??DataTable8  ;; INET_PROCESS
   \   00000010   ........           LDR      R6,??DataTable15  ;; hdr
   \   00000014   0090A0E1           MOV      R9,R0
   \   00000018   0C80A0E3           MOV      R8,#+12
   \   0000001C   00B0A0E3           MOV      R11,#+0
   \   00000020   020051E3           CMP      R1,#+2
   \   00000024   3E00001A           BNE      ??items_menu_ghook_0
    117            { 
    118              timer_id = GUI_NewTimer(data);
   \   00000028   A70300EF           SWI      +935
   \   0000002C   180086E5           STR      R0,[R6, #+24]
    119              hdr.icon = &hdr_icon;
   \   00000030   280086E2           ADD      R0,R6,#+40
   \   00000034   080086E5           STR      R0,[R6, #+8]
    120              void *hdr_pointer=  GetHeaderPointer(gui);
   \   00000038   0900A0E1           MOV      R0,R9
   \   0000003C   AE0200EF           SWI      +686
   \   00000040   00A0A0E1           MOV      R10,R0
    121              ws_hdr = AllocWS(64);
   \   00000044   4000A0E3           MOV      R0,#+64
   \   00000048   250100EF           SWI      +293
   \   0000004C   1C0086E5           STR      R0,[R6, #+28]
    122              UpdateHeader();
   \   00000050   001090E5           LDR      R1,[R0, #+0]
   \   00000054   B0B0C1E1           STRH     R11,[R1, #+0]
   \   00000058   1E10A0E3           MOV      R1,#+30
   \   0000005C   E01C81E3           ORR      R1,R1,#0xE000
   \   00000060   1C0000EF           SWI      +28
   \   00000064   1C0096E5           LDR      R0,[R6, #+28]
   \   00000068   E02087E2           ADD      R2,R7,#+224
   \   0000006C   0710A0E1           MOV      R1,R7
   \   00000070   240100EF           SWI      +292
   \   00000074   1C0096E5           LDR      R0,[R6, #+28]
   \   00000078   1D10A0E3           MOV      R1,#+29
   \   0000007C   E01C81E3           ORR      R1,R1,#0xE000
   \   00000080   1C0000EF           SWI      +28
   \   00000084   1C0096E5           LDR      R0,[R6, #+28]
   \   00000088   203096E5           LDR      R3,[R6, #+32]
   \   0000008C   242096E5           LDR      R2,[R6, #+36]
   \   00000090   EC1087E2           ADD      R1,R7,#+236
   \   00000094   160200EF           SWI      +534
    123              SetHeaderText(hdr_pointer, ws_hdr, malloc_adr(), mfree_adr());
   \   00000098   158000EF           SWI      +32789
   \   0000009C   00B0A0E1           MOV      R11,R0
   \   000000A0   148000EF           SWI      +32788
   \   000000A4   1C1096E5           LDR      R1,[R6, #+28]
   \   000000A8   0020A0E1           MOV      R2,R0
   \   000000AC   0B30A0E1           MOV      R3,R11
   \   000000B0   0A00A0E1           MOV      R0,R10
   \   000000B4   AF0200EF           SWI      +687
    124              
    125              if (list_empty(&dialogs))
   \   000000B8   ........           LDR      R0,??DataTable14  ;; dialogs
   \   000000BC   001090E5           LDR      R1,[R0, #+0]
   \   000000C0   000051E1           CMP      R1,R0
   \   000000C4   0500001A           BNE      ??items_menu_ghook_1
    126              {
    127                AnimWidget_Wait_center();
   \   000000C8   ........           _BLF     AnimWidget_Wait_center,??AnimWidget_Wait_center??rA
    128                GUI_StartTimerProc(gui, timer_id, 100, LoadSavedDialogs);//загружаем сохраненные диалоги
   \   000000CC   38319FE5           LDR      R3,??items_menu_ghook_2  ;; LoadSavedDialogs
   \   000000D0   181096E5           LDR      R1,[R6, #+24]
   \   000000D4   6420A0E3           MOV      R2,#+100
   \   000000D8   0900A0E1           MOV      R0,R9
   \   000000DC   A90300EF           SWI      +937
    129              }
    130              
    131              if (INET_PROCESS == 0)
   \                     ??items_menu_ghook_1:
   \   000000E0   000095E5           LDR      R0,[R5, #+0]
   \   000000E4   000050E3           CMP      R0,#+0
   \   000000E8   F18FBD18           POPNE    {R0,R4-R11,PC}
    132              {
    133                int count;
    134                if (IsGPRSEnabled())
   \   000000EC   A70000EF           SWI      +167
   \   000000F0   000050E3           CMP      R0,#+0
   \   000000F4   F18FBD08           POPEQ    {R0,R4-R11,PC}
    135                {
    136                  INET_PROCESS = LOAD_DIALOGS;
   \   000000F8   008085E5           STR      R8,[R5, #+0]
    137                  count = 10;
    138                  SUBPROC((void*)HttpSendReq, url_messages_getConversations(0, count, 1, "friend_status,has_photo,photo_50,online"), 1);//запрос списка диалогов
   \   000000FC   083087E2           ADD      R3,R7,#+8
   \   00000100   0120A0E3           MOV      R2,#+1
   \   00000104   0A10A0E3           MOV      R1,#+10
   \   00000108   0000A0E3           MOV      R0,#+0
   \   0000010C   ........           _BLF     url_messages_getConversations,??url_messages_getConversations??rA
   \   00000110   0120A0E3           MOV      R2,#+1
   \   00000114   0010A0E1           MOV      R1,R0
   \   00000118   0400A0E1           MOV      R0,R4
   \   0000011C   710100EF           SWI      +369
   \   00000120   F18FBDE8           POP      {R0,R4-R11,PC}
    139                  
    140                  //INET_PROCESS = TEST_SSL_CON;
    141                  //SUBPROC((void*)HttpSendReq, "https://m.mail.ru");
    142                }
    143              }
    144          
    145            }
    146               
    147            if (cmd == TI_CMD_UNFOCUS)
   \                     ??items_menu_ghook_0:
   \   00000124   090051E3           CMP      R1,#+9
   \   00000128   0300001A           BNE      ??items_menu_ghook_3
    148            {
    149              AnimWidget_Close();
   \   0000012C   ........           _BLF     AnimWidget_Close,??AnimWidget_Close??rA
    150              DisableDynImages();
   \   00000130   ........           _BLF     DisableDynImages,??DisableDynImages??rA
    151              DisableDynTheme();
   \   00000134   ........           _BLF     DisableDynTheme,??DisableDynTheme??rA
   \   00000138   F18FBDE8           POP      {R0,R4-R11,PC}
    152            }
    153            
    154            if (cmd == TI_CMD_FOCUS)
   \                     ??items_menu_ghook_3:
   \   0000013C   0A0051E3           CMP      R1,#+10
   \   00000140   0300001A           BNE      ??items_menu_ghook_4
    155            {
    156             // if (GetMenuItemCount(gui) == 0)
    157             //   AnimWidget_Wait_body();
    158              
    159              EnableDynImages();
   \   00000144   ........           _BLF     EnableDynImages,??EnableDynImages??rA
    160              EnableDynTheme();  
   \   00000148   ........           _BLF     EnableDynTheme,??EnableDynTheme??rA
    161              DisableIDLETMR();
   \   0000014C   7F0100EF           SWI      +383
   \   00000150   F18FBDE8           POP      {R0,R4-R11,PC}
    162              //Menu_SetItemCountDyn(gui, CLIST_GetCount(csm->dialogs_clist));
    163            }  
    164            
    165            if (cmd == TI_CMD_REDRAW)
   \                     ??items_menu_ghook_4:
   \   00000154   070051E3           CMP      R1,#+7
   \   00000158   2200001A           BNE      ??items_menu_ghook_5
    166            {
    167              cursor_pos = GetCurMenuItem(gui);
   \   0000015C   8F0100EF           SWI      +399
   \   00000160   0010A0E1           MOV      R1,R0
    168             if (items_count) cursor_pos++;
   \   00000164   200096E5           LDR      R0,[R6, #+32]
   \   00000168   000050E3           CMP      R0,#+0
   \   0000016C   01108112           ADDNE    R1,R1,#+1
   \   00000170   241086E5           STR      R1,[R6, #+36]
    169            
    170              if (INET_PROCESS == 0)
   \   00000174   001095E5           LDR      R1,[R5, #+0]
   \   00000178   000051E3           CMP      R1,#+0
   \   0000017C   0E00001A           BNE      ??items_menu_ghook_6
    171              {
    172                if (items_count && cursor_pos == items_count)
   \   00000180   000050E3           CMP      R0,#+0
   \   00000184   F18FBD08           POPEQ    {R0,R4-R11,PC}
   \   00000188   241096E5           LDR      R1,[R6, #+36]
   \   0000018C   000051E1           CMP      R1,R0
   \   00000190   F18FBD18           POPNE    {R0,R4-R11,PC}
    173                {
    174                  INET_PROCESS = LOAD_DIALOGS;
   \   00000194   008085E5           STR      R8,[R5, #+0]
    175                  SUBPROC((void*)HttpSendReq, url_messages_getConversations(items_count, 10, 1, "has_photo,photo_50,online"), 1);//запрос списка диалогов
   \   00000198   303087E2           ADD      R3,R7,#+48
   \   0000019C   0120A0E3           MOV      R2,#+1
   \   000001A0   0A10A0E3           MOV      R1,#+10
   \   000001A4   ........           _BLF     url_messages_getConversations,??url_messages_getConversations??rA
   \   000001A8   0120A0E3           MOV      R2,#+1
   \   000001AC   0010A0E1           MOV      R1,R0
   \   000001B0   0400A0E1           MOV      R0,R4
   \   000001B4   710100EF           SWI      +369
    176                  AnimWidget_Wait_bottom();
   \   000001B8   ........           _BLF     AnimWidget_Wait_bottom,??AnimWidget_Wait_bottom??rA
    177                }
    178              }
    179              
    180              if (INET_PROCESS && AnimWidget_IsBottom() && cursor_pos != items_count)
   \                     ??items_menu_ghook_6:
   \   000001BC   000095E5           LDR      R0,[R5, #+0]
   \   000001C0   000050E3           CMP      R0,#+0
   \   000001C4   F18FBD08           POPEQ    {R0,R4-R11,PC}
   \   000001C8   ........           _BLF     AnimWidget_IsBottom,??AnimWidget_IsBottom??rA
   \   000001CC   000050E3           CMP      R0,#+0
   \   000001D0   24009615           LDRNE    R0,[R6, #+36]
   \   000001D4   20109615           LDRNE    R1,[R6, #+32]
   \   000001D8   01005011           CMPNE    R0,R1
   \   000001DC   F18FBD08           POPEQ    {R0,R4-R11,PC}
    181                AnimWidget_Close();
   \   000001E0   ........           _BLF     AnimWidget_Close,??AnimWidget_Close??rA
   \   000001E4   F18FBDE8           POP      {R0,R4-R11,PC}
    182              
    183            }
    184            
    185            if (cmd == TI_CMD_DESTROY)
   \                     ??items_menu_ghook_5:
   \   000001E8   030051E3           CMP      R1,#+3
   \   000001EC   F18FBD18           POPNE    {R0,R4-R11,PC}
    186            {
    187              GUI_DeleteTimer(gui, timer_id);
   \   000001F0   181096E5           LDR      R1,[R6, #+24]
   \   000001F4   A80300EF           SWI      +936
    188              AnimWidget_Close();
   \   000001F8   ........           _BLF     AnimWidget_Close,??AnimWidget_Close??rA
    189              DisableDynTheme();
   \   000001FC   ........           _BLF     DisableDynTheme,??DisableDynTheme??rA
    190              DisableDynImages();
   \   00000200   ........           _BLF     DisableDynImages,??DisableDynImages??rA
    191              gui_id = 0;
   \   00000204   14B086E5           STR      R11,[R6, #+20]
    192            }
    193          }
   \   00000208   F18FBDE8           POP      {R0,R4-R11,PC}   ;; return
   \                     ??items_menu_ghook_2:
   \   0000020C   ........           DC32     LoadSavedDialogs
    194          
    195          extern void LoadUserPhoto();
    196          

   \                                 In segment CODE, align 4, keep-with-next
    197          static void items_menu_iconhndl(void *gui, int curitem, void *user_pointer)
    198          {
   \                     items_menu_iconhndl:
   \   00000000   F34F2DE9           PUSH     {R0,R1,R4-R11,LR}
    199            IMGHDR *item_icon = NULL;
    200            struct list_head *pos;
    201            VkDialog *dialog;
    202            VkMsg *msg;
    203            VkUser *user = NULL;
    204            VkGroup *group = NULL;
    205            
    206            pos = get_ListByIndex(&dialogs, curitem);
   \   00000004   ........           LDR      R0,??DataTable14  ;; dialogs
    207            dialog = list_entry(pos, VkDialog, list);
    208            msg = get_DialogMsg(dialog);
    209            if (dialog->from_id > 0)
    210              user = dialog->user;
    211            else
    212              group = dialog->group;
    213            
    214            WSHDR *ws1 = AllocMenuWS(gui, 64);
    215            WSHDR *ws2 = AllocMenuWS(gui, 64);
    216            void *item = AllocMLMenuItem(gui);
    217            
    218            wsAppendChar(ws1, UTF16_FONT_SMALL_BOLD);
    219            wsAppendChar(ws2, UTF16_FONT_SMALL);
    220          
    221            if (user && wstrlen(user->first_name))
   \   00000008   ........           LDR      R9,??DataTable12  ;; percent_t
   \   0000000C   00A0A0E3           MOV      R10,#+0
   \   00000010   ........           _BLF     get_ListByIndex,??get_ListByIndex??rA
   \   00000014   00B0A0E1           MOV      R11,R0
   \   00000018   ........           _BLF     get_DialogMsg,??get_DialogMsg??rA
   \   0000001C   0080A0E1           MOV      R8,R0
   \   00000020   08009BE5           LDR      R0,[R11, #+8]
   \   00000024   0040A0E3           MOV      R4,#+0
   \   00000028   010050E3           CMP      R0,#+1
   \   0000002C   00009DE5           LDR      R0,[SP, #+0]
   \   00000030   1C409BA5           LDRGE    R4,[R11, #+28]
   \   00000034   20A09BB5           LDRLT    R10,[R11, #+32]
   \   00000038   4010A0E3           MOV      R1,#+64
   \   0000003C   980100EF           SWI      +408
   \   00000040   0050A0E1           MOV      R5,R0
   \   00000044   00009DE5           LDR      R0,[SP, #+0]
   \   00000048   4010A0E3           MOV      R1,#+64
   \   0000004C   980100EF           SWI      +408
   \   00000050   0060A0E1           MOV      R6,R0
   \   00000054   00009DE5           LDR      R0,[SP, #+0]
   \   00000058   190200EF           SWI      +537
   \   0000005C   0070A0E1           MOV      R7,R0
   \   00000060   1310A0E3           MOV      R1,#+19
   \   00000064   E01C81E3           ORR      R1,R1,#0xE000
   \   00000068   0500A0E1           MOV      R0,R5
   \   0000006C   1C0000EF           SWI      +28
   \   00000070   1210A0E3           MOV      R1,#+18
   \   00000074   E01C81E3           ORR      R1,R1,#0xE000
   \   00000078   0600A0E1           MOV      R0,R6
   \   0000007C   1C0000EF           SWI      +28
   \   00000080   000054E3           CMP      R4,#+0
   \   00000084   1100000A           BEQ      ??items_menu_iconhndl_1
   \   00000088   0C0094E5           LDR      R0,[R4, #+12]
   \   0000008C   230100EF           SWI      +291
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   0D00000A           BEQ      ??items_menu_iconhndl_1
    222            {
    223              wstrcat(ws1, user->first_name);
   \   00000098   0C1094E5           LDR      R1,[R4, #+12]
   \   0000009C   0500A0E1           MOV      R0,R5
   \   000000A0   210100EF           SWI      +289
    224              if (wstrlen(user->last_name))
   \   000000A4   100094E5           LDR      R0,[R4, #+16]
   \   000000A8   230100EF           SWI      +291
   \   000000AC   000050E3           CMP      R0,#+0
   \   000000B0   1100000A           BEQ      ??items_menu_iconhndl_2
    225              {
    226                wsAppendChar(ws1, ' ');
   \   000000B4   2010A0E3           MOV      R1,#+32
   \   000000B8   0500A0E1           MOV      R0,R5
   \   000000BC   1C0000EF           SWI      +28
    227                wstrcat(ws1, user->last_name);
   \   000000C0   101094E5           LDR      R1,[R4, #+16]
   \                     ??items_menu_iconhndl_3:
   \   000000C4   0500A0E1           MOV      R0,R5
   \   000000C8   210100EF           SWI      +289
   \   000000CC   0A0000EA           B        ??items_menu_iconhndl_2
    228              }
    229            }
    230            else
    231              if (group && wstrlen(group->name))
   \                     ??items_menu_iconhndl_1:
   \   000000D0   00005AE3           CMP      R10,#+0
   \   000000D4   0400000A           BEQ      ??items_menu_iconhndl_4
   \   000000D8   0C009AE5           LDR      R0,[R10, #+12]
   \   000000DC   230100EF           SWI      +291
   \   000000E0   000050E3           CMP      R0,#+0
    232                wstrcat(ws1, group->name);
   \   000000E4   0C109A15           LDRNE    R1,[R10, #+12]
   \   000000E8   F5FFFF1A           BNE      ??items_menu_iconhndl_3
    233              else
    234                wstrcatprintf(ws1, percent_d, dialog->from_id);
   \                     ??items_menu_iconhndl_4:
   \   000000EC   08209BE5           LDR      R2,[R11, #+8]
   \   000000F0   031089E2           ADD      R1,R9,#+3
   \   000000F4   0500A0E1           MOV      R0,R5
   \   000000F8   160200EF           SWI      +534
    235              
    236              if (wstrlen(msg->text))//в сообщении есть текст
   \                     ??items_menu_iconhndl_2:
   \   000000FC   180098E5           LDR      R0,[R8, #+24]
   \   00000100   230100EF           SWI      +291
   \   00000104   000050E3           CMP      R0,#+0
   \   00000108   1C00000A           BEQ      ??items_menu_iconhndl_5
    237              {
    238                if (dialog->unread_count && msg->out == 0)//входящие непроч. красным
   \   0000010C   0C009BE5           LDR      R0,[R11, #+12]
   \   00000110   0610A0E3           MOV      R1,#+6
   \   00000114   E01C81E3           ORR      R1,R1,#0xE000
   \   00000118   000050E3           CMP      R0,#+0
   \   0000011C   0900000A           BEQ      ??items_menu_iconhndl_6
   \   00000120   1C0098E5           LDR      R0,[R8, #+28]
   \   00000124   000050E3           CMP      R0,#+0
   \   00000128   0600001A           BNE      ??items_menu_iconhndl_6
    239                {
    240                  wsAppendChar(ws2, UTF16_INK_RGBA);
   \   0000012C   0600A0E1           MOV      R0,R6
   \   00000130   1C0000EF           SWI      +28
    241                  wsAppendChar(ws2, 0xff00);//RG
   \   00000134   FF1CA0E3           MOV      R1,#+65280
   \   00000138   0600A0E1           MOV      R0,R6
   \   0000013C   1C0000EF           SWI      +28
    242                  wsAppendChar(ws2, 0x0064);//BA - красный
   \   00000140   6410A0E3           MOV      R1,#+100
   \   00000144   070000EA           B        ??items_menu_iconhndl_7
    243                }
    244                else
    245                {
    246                  wsAppendChar(ws2, UTF16_INK_RGBA);
   \                     ??items_menu_iconhndl_6:
   \   00000148   0600A0E1           MOV      R0,R6
   \   0000014C   1C0000EF           SWI      +28
    247                  wsAppendChar(ws2, 0x8080);//RG
   \   00000150   8010A0E3           MOV      R1,#+128
   \   00000154   801C81E3           ORR      R1,R1,#0x8000
   \   00000158   0600A0E1           MOV      R0,R6
   \   0000015C   1C0000EF           SWI      +28
    248                  wsAppendChar(ws2, 0x8064);//BA - серый
   \   00000160   6410A0E3           MOV      R1,#+100
   \   00000164   801C81E3           ORR      R1,R1,#0x8000
   \                     ??items_menu_iconhndl_7:
   \   00000168   0600A0E1           MOV      R0,R6
   \   0000016C   1C0000EF           SWI      +28
    249                }
    250                wstrcat(ws2, msg->text);
   \   00000170   181098E5           LDR      R1,[R8, #+24]
   \   00000174   0600A0E1           MOV      R0,R6
   \   00000178   210100EF           SWI      +289
   \   0000017C   2B0000EA           B        ??items_menu_iconhndl_8
    251              }
    252              else//иначе
    253                if (!list_empty(&msg->attachments))//если есть вложение(я)
   \                     ??items_menu_iconhndl_5:
   \   00000180   200088E2           ADD      R0,R8,#+32
   \   00000184   001090E5           LDR      R1,[R0, #+0]
   \   00000188   000051E1           CMP      R1,R0
   \   0000018C   2700000A           BEQ      ??items_menu_iconhndl_8
    254              {
    255                int count = count_ListElements(&msg->attachments);
   \   00000190   ........           _BLF     count_ListElements,??count_ListElements??rA
    256                
    257                if (count > 1)
   \   00000194   020050E3           CMP      R0,#+2
    258                  wstrcatprintf(ws2, "%d вложения", count);
   \   00000198   0020A0A1           MOVGE    R2,R0
   \   0000019C   4C1089A2           ADDGE    R1,R9,#+76
   \   000001A0   200000AA           BGE      ??items_menu_iconhndl_9
    259                else
    260                {
    261                  VkAttach *attach = list_entry(msg->attachments.next, VkAttach, list);
    262                  
    263                  switch(attach->type)
   \   000001A4   200098E5           LDR      R0,[R8, #+32]
   \   000001A8   080090E5           LDR      R0,[R0, #+8]
   \   000001AC   010040E2           SUB      R0,R0,#+1
   \   000001B0   0A0050E3           CMP      R0,#+10
   \   000001B4   1D00008A           BHI      ??items_menu_iconhndl_8
   \   000001B8   011F8FE2           ADR      R1,??items_menu_iconhndl_0
   \   000001BC   0010D1E7           LDRB     R1,[R1, R0]
   \   000001C0   01F18FE0           ADD      PC,PC,R1, LSL #+2
   \                     ??items_menu_iconhndl_0:
   \   000001C4   02040608           DC8      +2,+4,+6,+8
   \   000001C8   0A0C0E10           DC8      +10,+12,+14,+16
   \   000001CC   12141600           DC8      +18,+20,+22,+0
    264                  {
    265                  case 1: wstrcatprintf(ws2, percent_t, "Фотография");
   \                     ??items_menu_iconhndl_10:
   \   000001D0   582089E2           ADD      R2,R9,#+88
   \   000001D4   120000EA           B        ??items_menu_iconhndl_11
    266                  break;
    267                  case 2: wstrcatprintf(ws2, percent_t, "Видео");
   \                     ??items_menu_iconhndl_12:
   \   000001D8   642089E2           ADD      R2,R9,#+100
   \   000001DC   100000EA           B        ??items_menu_iconhndl_11
    268                  break;
    269                  case 3: wstrcatprintf(ws2, percent_t, "Аудиозапись");
   \                     ??items_menu_iconhndl_13:
   \   000001E0   6C2089E2           ADD      R2,R9,#+108
   \   000001E4   0E0000EA           B        ??items_menu_iconhndl_11
    270                  break;
    271                  case 4: wstrcatprintf(ws2, percent_t, "Документ");
   \                     ??items_menu_iconhndl_14:
   \   000001E8   782089E2           ADD      R2,R9,#+120
   \   000001EC   0C0000EA           B        ??items_menu_iconhndl_11
    272                  break;        
    273                  case 5: wstrcatprintf(ws2, percent_t, "Ссылка");
   \                     ??items_menu_iconhndl_15:
   \   000001F0   842089E2           ADD      R2,R9,#+132
   \   000001F4   0A0000EA           B        ??items_menu_iconhndl_11
    274                  break;
    275                  case 6: wstrcatprintf(ws2, percent_t, "Товар");
   \                     ??items_menu_iconhndl_16:
   \   000001F8   8C2089E2           ADD      R2,R9,#+140
   \   000001FC   080000EA           B        ??items_menu_iconhndl_11
    276                  break;
    277                  case 7: wstrcatprintf(ws2, percent_t, "Подборка товаров");
   \                     ??items_menu_iconhndl_17:
   \   00000200   942089E2           ADD      R2,R9,#+148
   \   00000204   060000EA           B        ??items_menu_iconhndl_11
    278                  break;
    279                  case 8: wstrcatprintf(ws2, percent_t, "Запись на стене");
   \                     ??items_menu_iconhndl_18:
   \   00000208   A82089E2           ADD      R2,R9,#+168
   \   0000020C   040000EA           B        ??items_menu_iconhndl_11
    280                  break;
    281                  case 9: wstrcatprintf(ws2, percent_t, "Комментарий на стене");
   \                     ??items_menu_iconhndl_19:
   \   00000210   B82089E2           ADD      R2,R9,#+184
   \   00000214   020000EA           B        ??items_menu_iconhndl_11
    282                  break;
    283                  case 10: wstrcatprintf(ws2, percent_t, "Стикер");
   \                     ??items_menu_iconhndl_20:
   \   00000218   D02089E2           ADD      R2,R9,#+208
   \   0000021C   000000EA           B        ??items_menu_iconhndl_11
    284                  break;
    285                  case 11: wstrcatprintf(ws2, percent_t, "Подарок");
   \                     ??items_menu_iconhndl_21:
   \   00000220   D82089E2           ADD      R2,R9,#+216
   \                     ??items_menu_iconhndl_11:
   \   00000224   0910A0E1           MOV      R1,R9
   \                     ??items_menu_iconhndl_9:
   \   00000228   0600A0E1           MOV      R0,R6
   \   0000022C   160200EF           SWI      +534
    286                  break;
    287                  }
    288                }
    289              }
    290              
    291          //первым рисуется картинка из SetMenuItemIconArray потом SetMenuItemIconIMGHDR
    292          #ifdef NEWSGOLD
    293              
    294              if (user && user->photo_50_img)
   \                     ??items_menu_iconhndl_8:
   \   00000230   000054E3           CMP      R4,#+0
   \   00000234   24209415           LDRNE    R2,[R4, #+36]
   \   00000238   00005213           CMPNE    R2,#+0
   \   0000023C   1400001A           BNE      ??items_menu_iconhndl_22
    295                item_icon = user->photo_50_img;
    296              else
    297                if (group && group->photo_50_img)
   \   00000240   00005AE3           CMP      R10,#+0
   \   00000244   24209A15           LDRNE    R2,[R10, #+36]
   \   00000248   00005213           CMPNE    R2,#+0
   \   0000024C   1000001A           BNE      ??items_menu_iconhndl_22
    298                  item_icon = group->photo_50_img;
    299                else
    300                  if (user && user->deactivated || group && group->deactivated)
   \   00000250   000054E3           CMP      R4,#+0
   \   00000254   14009415           LDRNE    R0,[R4, #+20]
   \   00000258   00005013           CMPNE    R0,#+0
   \   0000025C   0300001A           BNE      ??items_menu_iconhndl_23
   \   00000260   00005AE3           CMP      R10,#+0
   \   00000264   14009A15           LDRNE    R0,[R10, #+20]
   \   00000268   00005013           CMPNE    R0,#+0
   \   0000026C   0300000A           BEQ      ??items_menu_iconhndl_24
    301                    item_icon = PNGLIST_GetImgByIndex(0);//deactivated.png
   \                     ??items_menu_iconhndl_23:
   \   00000270   0000A0E3           MOV      R0,#+0
   \   00000274   ........           _BLF     PNGLIST_GetImgByIndex,??PNGLIST_GetImgByIndex??rA
   \   00000278   0020B0E1           MOVS     R2,R0
    302                    
    303              if (item_icon == NULL)
   \   0000027C   0200001A           BNE      ??items_menu_iconhndl_25
    304                item_icon = PNGLIST_GetImgByIndex(1);//camera.png
   \                     ??items_menu_iconhndl_24:
   \   00000280   0100A0E3           MOV      R0,#+1
   \   00000284   ........           _BLF     PNGLIST_GetImgByIndex,??PNGLIST_GetImgByIndex??rA
   \   00000288   0020A0E1           MOV      R2,R0
    305              
    306              if (item_icon)
   \                     ??items_menu_iconhndl_25:
   \   0000028C   000052E3           CMP      R2,#+0
   \   00000290   0200000A           BEQ      ??items_menu_iconhndl_26
    307                SetMenuItemIconIMGHDR(gui, item, item_icon);
   \                     ??items_menu_iconhndl_22:
   \   00000294   00009DE5           LDR      R0,[SP, #+0]
   \   00000298   0710A0E1           MOV      R1,R7
   \   0000029C   A30300EF           SWI      +931
    308          /*    
    309              if (process == 0)
    310              {
    311                ipc.name_to = ipc_my_name;
    312                ipc.name_from = ipc_my_name;
    313                ipc.data = &dialogs ;
    314                GBS_SendMessage(MMI_CEPID, MSG_IPC, IPC_LOAD_PHOTO_PROCESS, &ipc);        
    315              }
    316          */    
    317          #endif
    318              
    319              SetMLMenuItemText(gui, item, ws1, ws2, curitem);
   \                     ??items_menu_iconhndl_26:
   \   000002A0   04009DE5           LDR      R0,[SP, #+4]
   \   000002A4   0630A0E1           MOV      R3,R6
   \   000002A8   01002DE9           PUSH     {R0}
   \   000002AC   0520A0E1           MOV      R2,R5
   \   000002B0   04009DE5           LDR      R0,[SP, #+4]
   \   000002B4   0710A0E1           MOV      R1,R7
   \   000002B8   180200EF           SWI      +536
    320           //}
    321           // else
    322              //SetMLMenuItemText(gui, item, 0, 0, curitem);
    323          }
   \   000002BC   F78FBDE8           POP      {R0-R2,R4-R11,PC}  ;; return
    324          

   \                                 In segment DATA_C, align 4, align-sorted
    325          static const ML_MENU_DESC items_menu_desc=
   \                     items_menu_desc:
   \   00000000   10000000....       DC32 16, items_menu_onkey, items_menu_ghook, 0H, menusoftkeys, skt
   \              ............
   \              00000000....
   \              ............
   \   00000018   92000140....       DC32 1073807506, items_menu_iconhndl, 0H, 0H, 0, 1
   \              ....00000000
   \              000000000000
   \              000001000000
    326          {
    327            0x10,
    328            items_menu_onkey,
    329            items_menu_ghook,
    330            NULL,
    331            menusoftkeys,
    332            &skt,
    333          #ifdef NEWSGOLD  
    334            0x40010092, //0x80000083
    335          #else
    336            0x40014000,
    337          #endif
    338            items_menu_iconhndl,
    339            NULL,   //Items
    340            NULL,   //Procs
    341            0,   //n
    342            1 //Добавочных строк  
    343          };
    344          
    345          //******************************************************************************
    346          

   \                                 In segment CODE, align 4, keep-with-next
    347          void RefreshDialogsMenu()
    348          {  
   \                     RefreshDialogsMenu:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
    349            if (gui_id)
   \   00000004   54409FE5           LDR      R4,??RefreshDialogsMenu_0  ;; hdr
   \   00000008   140094E5           LDR      R0,[R4, #+20]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   7080BD08           POPEQ    {R4-R6,PC}
    350            {
    351              GUI* gui = FindGUIbyId(gui_id, NULL);
    352              csm->list = &dialogs;
   \   00000014   ........           LDR      R6,??DataTable14  ;; dialogs
   \   00000018   0010A0E3           MOV      R1,#+0
   \   0000001C   090200EF           SWI      +521
    353              GUI_StartTimerProc(gui, timer_id, 100, LoadUserPhoto);//ищем авки в cache    
   \   00000020   3C309FE5           LDR      R3,??RefreshDialogsMenu_0+0x4  ;; LoadUserPhoto
   \   00000024   0050A0E1           MOV      R5,R0
   \   00000028   38009FE5           LDR      R0,??RefreshDialogsMenu_0+0x8  ;; csm
   \   0000002C   6420A0E3           MOV      R2,#+100
   \   00000030   000090E5           LDR      R0,[R0, #+0]
   \   00000034   386080E5           STR      R6,[R0, #+56]
   \   00000038   181094E5           LDR      R1,[R4, #+24]
   \   0000003C   0500A0E1           MOV      R0,R5
   \   00000040   A90300EF           SWI      +937
    354              items_count = count_ListElements(&dialogs);
   \   00000044   0600A0E1           MOV      R0,R6
   \   00000048   ........           _BLF     count_ListElements,??count_ListElements??rA
   \   0000004C   200084E5           STR      R0,[R4, #+32]
    355              Menu_SetItemCountDyn(gui, items_count);
   \   00000050   0010A0E1           MOV      R1,R0
   \   00000054   0500A0E1           MOV      R0,R5
   \   00000058   E60100EF           SWI      +486
    356            }
    357          }
   \   0000005C   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??RefreshDialogsMenu_0:
   \   00000060   ........           DC32     hdr
   \   00000064   ........           DC32     LoadUserPhoto
   \   00000068   ........           DC32     csm
    358          
    359          //******************************************************************************
    360          

   \                                 In segment CODE, align 4, keep-with-next
    361          void CreateDialogsMenu()
    362          {
    363            int item_count = count_ListElements(&dialogs);
   \                     CreateDialogsMenu:
   \   00000000   ........           LDR      R0,??DataTable14  ;; dialogs
   \   00000004   70402DE9           PUSH     {R4-R6,LR}
   \   00000008   ........           _BLF     count_ListElements,??count_ListElements??rA
   \   0000000C   0040A0E1           MOV      R4,R0
    364            void *ma = malloc_adr(); 
   \   00000010   148000EF           SWI      +32788
   \   00000014   0050A0E1           MOV      R5,R0
    365            void *mf = mfree_adr();
   \   00000018   158000EF           SWI      +32789
    366            void *gui = GetMultiLinesMenuGUI(ma, mf); 
   \   0000001C   0010A0E1           MOV      R1,R0
   \   00000020   0500A0E1           MOV      R0,R5
   \   00000024   A50200EF           SWI      +677
    367            SetMenuToGUI(gui,&items_menu_desc);
   \   00000028   48109FE5           LDR      R1,??CreateDialogsMenu_0  ;; items_menu_desc
   \   0000002C   0060A0E1           MOV      R6,R0
   \   00000030   A70200EF           SWI      +679
    368            SetMenuItemCount(gui, item_count);
   \   00000034   0410A0E1           MOV      R1,R4
    369            SetCursorToMenuItem(gui, 0);
    370            patch_header(&hdr);
   \   00000038   ........           LDR      R4,??DataTable15  ;; hdr
   \   0000003C   0600A0E1           MOV      R0,R6
   \   00000040   C30100EF           SWI      +451
   \   00000044   0010A0E3           MOV      R1,#+0
   \   00000048   0600A0E1           MOV      R0,R6
   \   0000004C   C40100EF           SWI      +452
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           _BLF     patch_header,??patch_header??rA
    371            SetHeaderToMenu(gui,&hdr,ma); 
   \   00000058   0520A0E1           MOV      R2,R5
   \   0000005C   0410A0E1           MOV      R1,R4
   \   00000060   0600A0E1           MOV      R0,R6
   \   00000064   A60200EF           SWI      +678
    372            gui_id = CreateGUI(gui); 
   \   00000068   0600A0E1           MOV      R0,R6
   \   0000006C   370100EF           SWI      +311
   \   00000070   140084E5           STR      R0,[R4, #+20]
    373          }
   \   00000074   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateDialogsMenu_0:
   \   00000078   ........           DC32     items_menu_desc

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   ........           DC32     hdr + 32

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   ........           DC32     HttpSendReq

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable8:
   \   00000000   ........           DC32     INET_PROCESS

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable12:
   \   00000000   ........           DC32     percent_t

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable14:
   \   00000000   ........           DC32     dialogs

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable15:
   \   00000000   ........           DC32     hdr

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for hdr>`:
   \   00000000   000000000000       DC16 0, 0, 0, 0
   \              0000        
   \   00000008   000000000000       DC32 0H, 0, 2147483647
   \              0000FFFFFF7F
   \                     `?<Initializer for gui_id>`:
   \   00000014   00000000           DC32 0
   \                     `?<Initializer for timer_id>`:
   \   00000018   00000000           DC8 0, 0, 0, 0
   \                     `?<Initializer for ws_hdr>`:
   \   0000001C   00000000           DC32 0H
   \                     `?<Initializer for items_count>`:
   \   00000020   00000000           DC32 0
   \                     `?<Initializer for cursor_pos>`:
   \   00000024   00000000           DC32 0
   \                     `?<Initializer for hdr_icon>`:
   \   00000028   99050000           DC32 1433

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for sk>`:
   \   00000000   18000000           DC16 24, 0
   \   00000004   ........           DC32 `?<Constant "\\316\\341\\355\\356\\342\\350\\362\\374">`
   \   00000008   01000000           DC16 1, 0
   \   0000000C   ........           DC32 `?<Constant "\\315\\340\\347\\340\\344">`
   \   00000010   3D000000           DC16 61, 0
   \   00000014   FBC0FF7F           DC32 2147467515

   \                                 In segment DATA_ID, align 4, align-sorted
   \                     `?<Initializer for skt>`:
   \   00000000   ........0000       DC32 sk, 0
   \              0000        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "photo_50,online">`:
   \   00000000   70686F746F5F       DC8 "photo_50,online"
   \              35302C6F6E6C
   \              696E6500    

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\316\\341\\355\\356\\342\\350\\362\\374">`:
   \   00000000   CEE1EDEEE2E8       DC8 "\316\341\355\356\342\350\362\374"
   \              F2FC00      
   \   00000009   000000             DC8 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "\\315\\340\\347\\340\\344">`:
   \   00000000   CDE0E7E0E400       DC8 "\315\340\347\340\344"
   \   00000006   0000               DC8 0, 0
    374          
    375          

   Maximum stack usage in bytes:

     Function            CSTACK
     --------            ------
     CreateDialogsMenu      16
     RefreshDialogsMenu     16
     get_DialogsCount        0
     items_menu_ghook       40
     items_menu_iconhndl    48
     items_menu_onkey        4
     patch_header            8
     set_DialogsCount        0


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     patch_header                     52
     percent_t                       244
     hdr                              44
     set_DialogsCount                 12
     get_DialogsCount                 12
     menusoftkeys                     12
     sk                               24
     skt                               8
     items_menu_onkey                188
     items_menu_ghook                528
     items_menu_iconhndl             704
     items_menu_desc                  48
     RefreshDialogsMenu              108
     CreateDialogsMenu               124
     ??DataTable4                      4
     ??DataTable6                      4
     ??DataTable8                      4
     ??DataTable12                     4
     ??DataTable14                     4
     ??DataTable15                     4
     ?<Initializer for hdr>           44
     ?<Initializer for sk>            24
     ?<Initializer for skt>            8
     ?<Constant "photo_50,online">    16
     ?<Constant "\316\341\355\356\342\350\362\374">
                                      12
     ?<Constant "\315\340\347\340\344">
                                       8
      Others                         244

 
 1 984 bytes in segment CODE
   340 bytes in segment DATA_C
    76 bytes in segment DATA_I
    76 bytes in segment DATA_ID
    12 bytes in segment INITTAB
 
 1 700 bytes of CODE  memory (+ 296 bytes shared)
   416 bytes of CONST memory
    76 bytes of DATA  memory

Errors: none
Warnings: none
